<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/images/ScriptsSubConverter.png">
    <title>ä½¿ç”¨ä»‹ç»</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fb;
            min-height: 100vh;
        }
        nav {
            background: #ffffff;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 6px 18px rgba(0,0,0,0.05);
        }
        nav .nav-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 15px 30px; }
        nav .logo { color: #111827; font-size: 1.6em; font-weight: bold; display: flex; align-items: center; gap: 10px; text-decoration: none; }
        nav .logo img { height: 40px; width: auto; border-radius: 6px; }
        nav .nav-links { display: flex; gap: 15px; }
        nav .nav-btn { background: transparent; color: #4b5563; border: none; padding: 10px 18px; border-radius: 8px; cursor: pointer; font-size: 0.95em; transition: all 0.2s; font-weight: 600; text-decoration: none; }
        nav .nav-btn:hover { background: #eef2ff; color: #4338ca; transform: translateY(-1px); }
        nav .nav-btn.active { background: #4338ca; color: #ffffff; }
        .lang-toggle { background: #f3f4f6; color: #374151; padding: 6px 12px; border-radius: 6px; font-size: 0.85em; cursor: pointer; border: 1px solid #d1d5db; transition: all 0.2s; }
        .lang-toggle:hover { background: #e5e7eb; }
        .logout-btn { background: #dc3545; color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.85em; cursor: pointer; border: none; transition: all 0.2s; margin-left: 8px; }
        .logout-btn:hover { background: #c82333; }
        .container { max-width: 960px; margin: 0 auto; padding: 40px 20px; }
        .card { background: white; border-radius: 14px; padding: 36px; box-shadow: 0 12px 30px rgba(0,0,0,0.08); margin-bottom: 30px; border: 1px solid #e5e7eb; }
        .card h2 { color: #333; margin-bottom: 25px; font-size: 2em; border-bottom: 3px solid #4338ca; padding-bottom: 15px; }
        .intro-section { margin-bottom: 28px; }
        .intro-section h3 { color: #333; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .intro-section p { color: #444; line-height: 1.6; margin-bottom: 8px; }
        .intro-section ul { margin-left: 18px; color: #444; line-height: 1.6; }
        .intro-section ol { margin-left: 18px; color: #444; line-height: 1.6; }
        .intro-section li { margin-bottom: 6px; }
        .code-example {
            background: #0f172a;
            color: #e5e7eb;
            padding: 14px 16px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.93em;
            line-height: 1.55;
            white-space: pre;
            overflow: auto;
            border: 1px solid #1e293b;
        }
        @media (max-width: 768px) { nav .nav-container { flex-direction: column; gap: 15px; } nav .nav-links { width: 100%; justify-content: center; } .container { padding: 20px 15px; } .card { padding: 25px 20px; } }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="/" class="logo">
                <img src="/images/ScriptsSubConverter.png" alt="ScriptsSubConverter">
                <span data-zh="è®¢é˜…è½¬æ¢å™¨" data-en="ScriptsSubConverter">è®¢é˜…è½¬æ¢å™¨</span>
            </a>
            <div class="nav-links">
                <a class="nav-btn" href="/index.html" data-zh="è½¬æ¢" data-en="Convert">è½¬æ¢</a>
                <a class="nav-btn" href="/scripts.html" data-zh="è„šæœ¬" data-en="Scripts">è„šæœ¬</a>
                <a class="nav-btn active" href="/docs.html" data-zh="ä»‹ç»" data-en="Docs">ä»‹ç»</a>
                <button class="lang-toggle" onclick="toggleLang()">ä¸­/EN</button>
                <button class="logout-btn" onclick="logout()" data-zh="ç™»å‡º" data-en="Logout">ç™»å‡º</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="card">
            <h2 data-zh="ğŸ“– ä½¿ç”¨ä»‹ç»" data-en="ğŸ“– Documentation">ğŸ“– ä½¿ç”¨ä»‹ç»</h2>

            <div class="intro-section">
                <h3 data-zh="ğŸš€ å·²å®ç°åŠŸèƒ½" data-en="ğŸš€ Implemented Features">ğŸš€ å·²å®ç°åŠŸèƒ½</h3>
                <ul>
                    <li data-zh="/convertï¼šGETï¼Œå¿…å¡« script/subï¼Œå¯é€‰ filenameï¼›æ”¯æŒ data=Base64 æ‰“åŒ…" data-en="/convert: GET endpoint, requires script/sub, optional filename; supports data=Base64">/convertï¼šGETï¼Œå¿…å¡« script/subï¼Œå¯é€‰ filenameï¼›æ”¯æŒ data=Base64 æ‰“åŒ…</li>
                    <li data-zh="/api/scriptsï¼šåˆ—å‡ºã€è·å–ã€ä¿å­˜ï¼ˆè¯­æ³•æ ¡éªŒï¼‰ã€åˆ é™¤è„šæœ¬" data-en="/api/scripts: list, get, save (with syntax check), delete scripts">/api/scriptsï¼šåˆ—å‡ºã€è·å–ã€ä¿å­˜ï¼ˆè¯­æ³•æ ¡éªŒï¼‰ã€åˆ é™¤è„šæœ¬</li>
                    <li data-zh="è¾“å‡ºä¸º text/yamlï¼Œæ–‡ä»¶åç”¨ RFC5987 ç¼–ç ï¼Œé»˜è®¤ subscription.yaml" data-en="Output is text/yaml, filename uses RFC5987, defaults to subscription.yaml">è¾“å‡ºä¸º text/yamlï¼Œæ–‡ä»¶åç”¨ RFC5987 ç¼–ç ï¼Œé»˜è®¤ subscription.yaml</li>
                    <li data-zh="å¥åº·æ£€æŸ¥ï¼š/health è¿”å›çŠ¶æ€ä¸æ—¶é—´æˆ³" data-en="Health check: /health returns status and timestamp">å¥åº·æ£€æŸ¥ï¼š/health è¿”å›çŠ¶æ€ä¸æ—¶é—´æˆ³</li>
                    <li data-zh="é™æ€é¡µé¢ï¼šè½¬æ¢/è„šæœ¬ç®¡ç†/æ–‡æ¡£" data-en="Static pages: Convert/Scripts/Docs">é™æ€é¡µé¢ï¼šè½¬æ¢/è„šæœ¬ç®¡ç†/æ–‡æ¡£</li>
                </ul>
            </div>

            <div class="intro-section">
                <h3 data-zh="ğŸ“‹ åŸºæœ¬æµç¨‹" data-en="ğŸ“‹ Basic Workflow">ğŸ“‹ åŸºæœ¬æµç¨‹</h3>
                <ol>
                    <li data-zh="åœ¨"è„šæœ¬"é¡µä¿å­˜è„šæœ¬ï¼ˆæ–‡æœ¬å¤„ç†æˆ– Clash é…ç½®å¤„ç†ï¼‰" data-en="Save script in 'Scripts' page (text or Clash config processing)">åœ¨"è„šæœ¬"é¡µä¿å­˜è„šæœ¬ï¼ˆæ–‡æœ¬å¤„ç†æˆ– Clash é…ç½®å¤„ç†ï¼‰</li>
                    <li data-zh="åœ¨"è½¬æ¢"é¡µé€‰æ‹©è„šæœ¬ï¼Œè¾“å…¥è®¢é˜…é“¾æ¥ï¼Œå¯é€‰æ–‡ä»¶åï¼Œç”Ÿæˆé“¾æ¥" data-en="In 'Convert', select script, enter URL, optional filename, generate link">åœ¨"è½¬æ¢"é¡µé€‰æ‹©è„šæœ¬ï¼Œè¾“å…¥è®¢é˜…é“¾æ¥ï¼Œå¯é€‰æ–‡ä»¶åï¼Œç”Ÿæˆé“¾æ¥</li>
                    <li data-zh="å°†ç”Ÿæˆçš„é“¾æ¥ç²˜è´´åˆ° Clash ç­‰å®¢æˆ·ç«¯è®¢é˜…åœ°å€" data-en="Paste generated link into Clash or other client">å°†ç”Ÿæˆçš„é“¾æ¥ç²˜è´´åˆ° Clash ç­‰å®¢æˆ·ç«¯è®¢é˜…åœ°å€</li>
                </ol>
            </div>

            <div class="intro-section">
                <h3 data-zh="âš™ï¸ å‚æ•°è¯´æ˜" data-en="âš™ï¸ Parameters">âš™ï¸ å‚æ•°è¯´æ˜</h3>
                <ul>
                    <li data-zh="scriptï¼šè„šæœ¬åï¼ˆå¯¹åº” data/scripts/<name>.jsï¼‰" data-en="script: script name (maps to data/scripts/<name>.js)">scriptï¼šè„šæœ¬åï¼ˆå¯¹åº” data/scripts/<name>.jsï¼‰</li>
                    <li data-zh="subï¼šåŸå§‹è®¢é˜… URLï¼ˆå¿…å¡«ï¼‰" data-en="sub: original subscription URL (required)">subï¼šåŸå§‹è®¢é˜… URLï¼ˆå¿…å¡«ï¼‰</li>
                    <li data-zh="filenameï¼šå¯¼å‡ºæ–‡ä»¶åï¼ˆå¯é€‰ï¼Œé»˜è®¤ subscription.yamlï¼‰" data-en="filename: export filename (optional, default subscription.yaml)">filenameï¼šå¯¼å‡ºæ–‡ä»¶åï¼ˆå¯é€‰ï¼Œé»˜è®¤ subscription.yamlï¼‰</li>
                    <li data-zh="dataï¼šå¯é€‰ï¼ŒBase64 ç¼–ç çš„æŸ¥è¯¢ä¸²" data-en="data: optional, Base64 encoded query string">dataï¼šå¯é€‰ï¼ŒBase64 ç¼–ç çš„æŸ¥è¯¢ä¸²</li>
                </ul>
            </div>

            <div class="intro-section">
                <h3 data-zh="ğŸ” ç¼–ç æ–¹æ¡ˆ" data-en="ğŸ” Encoding Options">ğŸ” ç¼–ç æ–¹æ¡ˆ</h3>
                <ul>
                    <li data-zh="URL æ¨¡å¼ï¼š/convert?script=xxx&sub=yyy[&filename=zzz]" data-en="URL mode: /convert?script=xxx&sub=yyy[&filename=zzz]">URL æ¨¡å¼ï¼š/convert?script=xxx&sub=yyy[&filename=zzz]</li>
                    <li data-zh="Base64 æ¨¡å¼ï¼š/convert?data=BASE64(queryString)ï¼Œé¿å… HTTPS åµŒå¥—" data-en="Base64 mode: /convert?data=BASE64(query), avoids HTTPS nesting">Base64 æ¨¡å¼ï¼š/convert?data=BASE64(queryString)ï¼Œé¿å… HTTPS åµŒå¥—</li>
                </ul>
            </div>

            <div class="intro-section">
                <h3 data-zh="ğŸ“ è„šæœ¬æ‰§è¡Œ" data-en="ğŸ“ Script Execution">ğŸ“ è„šæœ¬æ‰§è¡Œ</h3>
                <ul>
                    <li data-zh="æ–‡æœ¬è„šæœ¬ï¼š(content) => stringï¼Œè¿”å›å­—ç¬¦ä¸²" data-en="Text script: (content) => string, returns string">æ–‡æœ¬è„šæœ¬ï¼š(content) => stringï¼Œè¿”å›å­—ç¬¦ä¸²</li>
                    <li data-zh="Clash è„šæœ¬ï¼šmain(config)ï¼Œè¿”å›å¯¹è±¡ï¼Œè‡ªåŠ¨è½¬ YAML" data-en="Clash script: main(config), returns object, auto-converts to YAML">Clash è„šæœ¬ï¼šmain(config)ï¼Œè¿”å›å¯¹è±¡ï¼Œè‡ªåŠ¨è½¬ YAML</li>
                    <li data-zh="åˆ¤å®šï¼šèƒ½è§£æä¸º YAML/JSON åˆ™ Clash æ¨¡å¼ï¼Œå¦åˆ™æ–‡æœ¬æ¨¡å¼" data-en="Detection: parseable as YAML/JSON uses Clash mode, else text">åˆ¤å®šï¼šèƒ½è§£æä¸º YAML/JSON åˆ™ Clash æ¨¡å¼ï¼Œå¦åˆ™æ–‡æœ¬æ¨¡å¼</li>
                    <li data-zh="æ‰§è¡Œï¼šnew Function åœ¨ Node è¿›ç¨‹å†…ï¼Œæ— æ²™ç®±ï¼Œå¯ç”¨ require/fs" data-en="Execution: new Function in Node process, no sandbox, can use require/fs">æ‰§è¡Œï¼šnew Function åœ¨ Node è¿›ç¨‹å†…ï¼Œæ— æ²™ç®±ï¼Œå¯ç”¨ require/fs</li>
                    <li data-zh="é”™è¯¯æ—¶å›é€€åŸå§‹å†…å®¹" data-en="Falls back to original on error">é”™è¯¯æ—¶å›é€€åŸå§‹å†…å®¹</li>
                </ul>
            </div>

            <div class="intro-section">
                <h3 data-zh="ğŸ“¦ é¢„ç½®è„šæœ¬" data-en="ğŸ“¦ Preset Scripts">ğŸ“¦ é¢„ç½®è„šæœ¬</h3>
                <ul>
                    <li data-zh="minifyï¼šå»ç©ºè¡Œ/æ³¨é‡Šï¼Œå‹ç¼©æ–‡æœ¬è®¢é˜…" data-en="minify: remove blanks/comments, compress text">minifyï¼šå»ç©ºè¡Œ/æ³¨é‡Šï¼Œå‹ç¼©æ–‡æœ¬è®¢é˜…</li>
                    <li data-zh="ss-vmess-onlyï¼šåªä¿ç•™ ss/vmess åè®®" data-en="ss-vmess-only: keep only ss/vmess protocols">ss-vmess-onlyï¼šåªä¿ç•™ ss/vmess åè®®</li>
                    <li data-zh="geo-priorityï¼šåœ°åŒºåˆ†ç»„æµ‹é€Ÿï¼ˆHK/SG/JP/USï¼‰ï¼ŒCN ç›´è¿" data-en="geo-priority: region groups (HK/SG/JP/US), CN direct">geo-priorityï¼šåœ°åŒºåˆ†ç»„æµ‹é€Ÿï¼ˆHK/SG/JP/USï¼‰ï¼ŒCN ç›´è¿</li>
                    <li data-zh="acl-miniï¼šæç®€åˆ†æµï¼Œå¹¿å‘Šæ‹’ç» + GFW ä»£ç† + CN ç›´è¿" data-en="acl-mini: minimal routing, ad block + GFW proxy + CN direct">acl-miniï¼šæç®€åˆ†æµï¼Œå¹¿å‘Šæ‹’ç» + GFW ä»£ç† + CN ç›´è¿</li>
                    <li data-zh="acl-liteï¼šå¸¸è§„åˆ†æµï¼Œå«åª’ä½“/ç”µæŠ¥è§„åˆ™é›†" data-en="acl-lite: standard routing with media/telegram rulesets">acl-liteï¼šå¸¸è§„åˆ†æµï¼Œå«åª’ä½“/ç”µæŠ¥è§„åˆ™é›†</li>
                    <li data-zh="clash-fullï¼šæ³¨å…¥åŸºç¡€è§„åˆ™ã€åˆ†ç»„ä¸åœ¨çº¿è§„åˆ™æä¾›è€…" data-en="clash-full: inject basic rules, groups and online providers">clash-fullï¼šæ³¨å…¥åŸºç¡€è§„åˆ™ã€åˆ†ç»„ä¸åœ¨çº¿è§„åˆ™æä¾›è€…</li>
                    <li data-zh="clash-proï¼šç»†åˆ†ç­–ç•¥ç»„ä¸è§„åˆ™ï¼Œå«å¹¿å‘Š/éšç§è§„åˆ™" data-en="clash-pro: refined groups and rules with ad/privacy">clash-proï¼šç»†åˆ†ç­–ç•¥ç»„ä¸è§„åˆ™ï¼Œå«å¹¿å‘Š/éšç§è§„åˆ™</li>
                </ul>
            </div>

            <div class="intro-section">
                <h3 data-zh="ğŸ’¡ å¸¸è§é—®é¢˜" data-en="ğŸ’¡ FAQ">ğŸ’¡ å¸¸è§é—®é¢˜</h3>
                <ul>
                    <li data-zh="æ‹‰å–å¤±è´¥ï¼šHTTPS åµŒå¥—æˆ–é‡å®šå‘æ—¶ç”¨ Base64 æ¨¡å¼" data-en="Fetch fails: use Base64 mode for HTTPS nesting/redirects">æ‹‰å–å¤±è´¥ï¼šHTTPS åµŒå¥—æˆ–é‡å®šå‘æ—¶ç”¨ Base64 æ¨¡å¼</li>
                    <li data-zh="æ–‡ä»¶åä¹±ç ï¼šå¡« filenameï¼ŒæœåŠ¡ç«¯ä½¿ç”¨ RFC5987" data-en="Filename encoding: set filename, server uses RFC5987">æ–‡ä»¶åä¹±ç ï¼šå¡« filenameï¼ŒæœåŠ¡ç«¯ä½¿ç”¨ RFC5987</li>
                    <li data-zh="è„šæœ¬æœªç”Ÿæ•ˆï¼šä¿å­˜ååˆ·æ–°è„šæœ¬ä¸‹æ‹‰ï¼Œé‡æ–°ç”Ÿæˆé“¾æ¥" data-en="Script not working: refresh dropdown after save, regenerate link">è„šæœ¬æœªç”Ÿæ•ˆï¼šä¿å­˜ååˆ·æ–°è„šæœ¬ä¸‹æ‹‰ï¼Œé‡æ–°ç”Ÿæˆé“¾æ¥</li>
                    <li data-zh="å®‰å…¨æ€§ï¼šè„šæœ¬å¯è®¿é—® Node å…¨å±€å’Œ fs/httpï¼Œè¯·è‡ªè¡Œè¯„ä¼°" data-en="Security: scripts can access Node globals and fs/http, evaluate risks">å®‰å…¨æ€§ï¼šè„šæœ¬å¯è®¿é—® Node å…¨å±€å’Œ fs/httpï¼Œè¯·è‡ªè¡Œè¯„ä¼°</li>
                </ul>
            </div>

            <div class="intro-section">
                <h3 data-zh="ğŸ§© å‚è€ƒæ–‡æ¡£" data-en="ğŸ§© References">ğŸ§© å‚è€ƒæ–‡æ¡£</h3>
                <p>
                    <span data-zh="è§„åˆ™å†™æ³•å‚è€ƒ" data-en="Rules reference">è§„åˆ™å†™æ³•å‚è€ƒ</span> 
                    <a href="https://wiki.metacubex.one/config/rules/" target="_blank">Clash Mihomo</a>ï¼›
                    <span data-zh="JS è¯­æ³•å‚è€ƒ" data-en="JavaScript syntax">JS è¯­æ³•å‚è€ƒ</span> 
                    <a href="https://www.runoob.com/js/js-tutorial.html" target="_blank" data-zh="JavaScript æ•™ç¨‹" data-en="Tutorial">JavaScript æ•™ç¨‹</a>
                </p>
            </div>
        </div>
    </div>
    <script>
        function toggleLang() {
            const current = localStorage.getItem('lang') || 'zh';
            const newLang = current === 'zh' ? 'en' : 'zh';
            localStorage.setItem('lang', newLang);
            applyLang(newLang);
        }

        function applyLang(lang) {
            document.querySelectorAll('[data-zh]').forEach(el => {
                const text = el.getAttribute(`data-${lang}`);
                if (text) {
                    if (el.tagName === 'SPAN' || el.tagName === 'A') {
                        // åªæ›´æ–°æ–‡æœ¬èŠ‚ç‚¹ï¼Œä¿ç•™å­å…ƒç´ 
                        if (el.childNodes.length === 1 && el.childNodes[0].nodeType === 3) {
                            el.textContent = text;
                        }
                    } else {
                        el.textContent = text;
                    }
                }
            });
        }

        window.addEventListener('DOMContentLoaded', () => {
            const lang = localStorage.getItem('lang') || 'zh';
            if (lang === 'en') applyLang('en');
        });

        // ç™»å‡ºåŠŸèƒ½
        async function logout() {
            try {
                await fetch('/api/logout', { method: 'POST' });
                window.location.href = '/login';
            } catch (error) {
                console.error('Logout error:', error);
                window.location.href = '/login';
            }
        }
    </script>
</body>
</html>
